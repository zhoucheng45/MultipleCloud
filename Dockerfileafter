# 第一阶段:编译Maven项目
FROM jdk-17-maven3.9.4:v1 AS build

WORKDIR /app

ARG PROJECT_NAME=after

COPY . .
WORKDIR /app/${PROJECT_NAME}
RUN mvn clean package -DskipTests=true


# 第二阶段:构建镜像
FROM openjdk:11-jdk-slim
WORKDIR /app
COPY --from=build /app/${PROJECT_NAME}/target/${PROJECT_NAME}.jar /app/${PROJECT_NAME}.jar
ENTRYPOINT ["java", "-jar", "/app/${PROJECT_NAME}.jar"]
